<?php

require_once('incl/old.incl.php');

function json_decode2($json,$dbg=false) {
	$tr = array();
	$escape = 0; $instr = 0;
	$nm = ''; $vl = ''; $atnm = true;
	$strtype = ''; 

	if ($dbg) echo "\n$json\n";

	for ($i=0; $i<strlen($json); $i++) {
		$c = $json[$i];
		if ($dbg) echo "$c instr=$instr escape=$escape atnm=$atnm\n";
		if ($escape > 0) {
			if ($atnm) $nm .= $c; else $vl .= $c;
			$escape--;
		} elseif ($instr > 0) {
			switch($c) {
				case $strtype:
				case ']':
					$instr--;
					break;
				case '[':
					$instr++;
					break;
				case '\\':
					$c = '';
					$escape++;
					break;
			}
			if ($instr > 0) {
				if ($atnm) $nm .= $c; else $vl .= $c;
			}
		} else {
			switch ($c) {
				case '\\': $escape++; break;
				case ':': $atnm = false; break;
				case '\'': 
				case '"': $strtype=$c; $instr++; break;
				case ']': break;
				case '[': $instr++; break;
				case '{': $curarray = array(); break;
				case '}':
				case ',':
					if (isset($curarray)) $curarray[$nm] = ((substr($vl,0,1)=='{')?json_decode2($vl):$vl);
					$nm = ''; $vl = ''; $atnm = true;
					if ($c!='}') break;
					$tr[] = $curarray;
					unset($curarray);
					break;
				default:
					if ($atnm) $nm .= $c; else $vl .= $c;
			}
		}
	}
	if ($dbg) { print_r($tr); cleanup(''); }
	return $tr;
}

do_connect();
run_sql('delete from tblDBCItemVendorCost');

//$whpage was get_url_old('http://www.wowhead.com/items?filter=qu=1;cr=87:92:86;crs=11:1:12;crv=0:0:0;gb=0');
// used to do this: delete FROM `tblItemVendorCost` where itemid in (52185,53010,52555,43007)

// use this instead to include better-than-common: http://www.wowhead.com/items?filter=cr=87:92:86;crs=11:1:12;crv=0:0:0
// see http://www.wowhead.com/items?filter=cr=92:158:86:87;crs=1:-2323:12:11;crv=0:0:0:0 to exclude some


$thejson = <<<EOF
{"classs":7,"flags2":-2147475200,"id":120945,"level":100,"name":"5Primal Spirit","reqlevel":90,"slot":0,"source":[2,3,4,17,19,23,25],"sourcemore":[{"p":3}],"subclass":10,firstseenpatch: 0,cost:[0,[],[[111557,5]]]},{"classs":7,"flags2":-2147475456,"id":109118,"level":100,"name":"6Blackrock Ore","slot":0,"source":[2,5,19],"subclass":7,firstseenpatch: 0,"avgbuyout":7333,"sellprice":350,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109119,"level":100,"name":"6True Iron Ore","slot":0,"source":[2,5,19],"subclass":7,firstseenpatch: 0,"avgbuyout":6850,"sellprice":1500,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109124,"level":100,"name":"6Frostweed","slot":0,"source":[2,5,17],"subclass":9,firstseenpatch: 0,"avgbuyout":15187,"buyprice":9848,"sellprice":2462,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109125,"level":100,"name":"6Fireweed","slot":0,"source":[2,5,17],"subclass":9,firstseenpatch: 0,"avgbuyout":10572,"buyprice":9848,"sellprice":2462,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109126,"level":100,"name":"6Gorgrond Flytrap","slot":0,"source":[2,5,17],"subclass":9,firstseenpatch: 0,"avgbuyout":12424,"buyprice":9848,"sellprice":2462,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109127,"level":100,"name":"6Starflower","slot":0,"source":[2,5,17],"subclass":9,firstseenpatch: 0,"avgbuyout":9925,"buyprice":9848,"sellprice":2462,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109128,"level":100,"name":"6Nagrand Arrowbloom","slot":0,"source":[2,5,17],"subclass":9,firstseenpatch: 0,"avgbuyout":10320,"buyprice":9848,"sellprice":2462,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109129,"level":100,"name":"6Talador Orchid","slot":0,"source":[2,5,17],"subclass":9,firstseenpatch: 0,"avgbuyout":11034,"buyprice":9848,"sellprice":2462,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109131,"level":100,"name":"6Raw Clefthoof Meat","slot":0,"source":[2,5],"subclass":8,firstseenpatch: 0,"avgbuyout":16334,"buyprice":1200,"sellprice":300,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109132,"level":100,"name":"6Raw Talbuk Meat","slot":0,"source":[2,5],"subclass":8,firstseenpatch: 0,"avgbuyout":42075,"buyprice":1200,"sellprice":300,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109133,"level":100,"name":"6Rylak Egg","slot":0,"source":[2,5],"subclass":8,firstseenpatch: 0,"avgbuyout":66000,"buyprice":1200,"sellprice":300,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109134,"level":100,"name":"6Raw Elekk Meat","slot":0,"source":[2,5],"subclass":8,firstseenpatch: 0,"avgbuyout":17397,"buyprice":1200,"sellprice":300,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109135,"level":100,"name":"6Raw Riverbeast Meat","slot":0,"source":[2,5],"subclass":8,firstseenpatch: 0,"avgbuyout":92500,"buyprice":1200,"sellprice":300,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109136,"level":100,"name":"6Raw Boar Meat","slot":0,"source":[2,5],"subclass":8,firstseenpatch: 0,"avgbuyout":86400,"buyprice":1200,"sellprice":300,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109137,"level":100,"name":"6Crescent Saberfish Flesh","slot":0,"source":[5],"subclass":8,firstseenpatch: 0,"avgbuyout":5999,"buyprice":1200,"sellprice":30,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109138,"level":100,"name":"6Jawless Skulker Flesh","slot":0,"source":[5],"subclass":8,firstseenpatch: 0,"avgbuyout":8495,"buyprice":1200,"sellprice":30,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109139,"level":100,"name":"6Fat Sleeper Flesh","slot":0,"source":[5],"subclass":8,firstseenpatch: 0,"avgbuyout":8700,"buyprice":1200,"sellprice":30,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109140,"level":100,"name":"6Blind Lake Sturgeon Flesh","slot":0,"source":[5],"subclass":8,firstseenpatch: 0,"avgbuyout":7271,"buyprice":1200,"sellprice":30,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109141,"level":100,"name":"6Fire Ammonite Tentacle","slot":0,"source":[5],"subclass":8,firstseenpatch: 0,"avgbuyout":11700,"buyprice":1200,"sellprice":30,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109142,"level":100,"name":"6Sea Scorpion Segment","slot":0,"source":[2,5],"sourcemore":[{"n":"Frostdeep Cavedweller","t":1,"ti":81171,"z":7004}],"subclass":8,firstseenpatch: 0,"avgbuyout":27126,"buyprice":1200,"sellprice":30,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109143,"level":100,"name":"6Abyssal Gulper Eel Flesh","slot":0,"source":[5],"subclass":8,firstseenpatch: 0,"avgbuyout":18200,"buyprice":1200,"sellprice":30,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109144,"level":100,"name":"6Blackwater Whiptail Flesh","slot":0,"source":[5],"subclass":8,firstseenpatch: 0,"avgbuyout":6900,"buyprice":1200,"sellprice":30,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":109693,"level":100,"name":"6Draenic Dust","slot":0,"source":[2,5,15],"subclass":12,firstseenpatch: 0,"avgbuyout":44795,"buyprice":28000,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":110609,"level":100,"name":"6Raw Beast Hide","slot":0,"source":[2,5,23],"subclass":6,firstseenpatch: 0,"avgbuyout":24475,"sellprice":1,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":76061,"level":90,"name":"4Spirit of Harmony","reqlevel":89,"slot":0,"source":[2,3,4],"sourcemore":[{"p":3},{"c":6138,"c2":12,"n":"Many More Giant Dinosaur Bones","t":5,"ti":32615}],"subclass":10,firstseenpatch: 0,"avgbuyout":475200,"buyprice":9999999,cost:[0,[[392,600]],[]]},{"classs":3,"flags2":-2147475456,"id":76734,"level":90,"name":"4Serpent's Eye","slot":0,"source":[5],"sourcemore":[{"z":5840}],"subclass":8,firstseenpatch: 0,"avgbuyout":47198,"sellprice":5000,cost:[0,[],[[76061,1]]]},{"classs":7,"flags2":-2147459072,"id":80433,"level":90,"name":"4Blood Spirit","slot":0,"source":[2,5,15],"sourcemore":[{"z":6507}],"subclass":12,firstseenpatch: 0,"avgbuyout":6937,"buyprice":2000000,"sellprice":5000,cost:[2000000]},{"classs":7,"flags2":-2147475456,"id":83092,"level":90,"name":"4Orb of Mystery","slot":0,"source":[2,5],"sourcemore":[{"n":"Big Keech","t":1,"ti":61650,"z":5840}],"subclass":11,firstseenpatch: 0,"avgbuyout":9999900,"buyprice":200000000,cost:[200000000]},{"classs":7,"flags2":-2147475456,"id":72094,"level":90,"name":"5Black Trillium Ore","reqlevel":75,"slot":0,"source":[2,5,19],"sourcemore":[{"z":5840}],"subclass":7,firstseenpatch: 0,"avgbuyout":34400,"reqskill":755,"reqskillrank":600,"sellprice":350,cost:[0,[],[[76061,1]]]},{"classs":7,"flags2":-2147475456,"id":72103,"level":90,"name":"5White Trillium Ore","reqlevel":75,"slot":0,"source":[2,5,19],"sourcemore":[{"z":5840}],"subclass":7,firstseenpatch: 0,"avgbuyout":32800,"reqskill":755,"reqskillrank":600,"sellprice":350,cost:[0,[],[[76061,1]]]},{"classs":7,"flags2":-2147475456,"id":72238,"level":90,"name":"5Golden Lotus","slot":0,"source":[2,5,17],"sourcemore":[{"z":5840}],"subclass":9,firstseenpatch: 0,"avgbuyout":95597,"sellprice":1,cost:[0,[],[[76061,1]]]},{"classs":7,"flags2":-2147459072,"id":111557,"level":90,"name":"6Sumptuous Fur","slot":0,"source":[2,5],"subclass":5,firstseenpatch: 0,"avgbuyout":20444,"sellprice":1750,cost:[0,[[824,6]],[]]},{"classs":7,"flags2":-2147475456,"id":72093,"level":88,"name":"6Kyparite","reqlevel":75,"slot":0,"source":[2,5,19],"sourcemore":[{"z":5840}],"subclass":7,firstseenpatch: 0,"avgbuyout":5200,"reqskill":755,"reqskillrank":550,"sellprice":750,cost:[0,[],[[76061,1]]]},{"classs":7,"flags2":-2147475456,"id":72092,"level":86,"name":"6Ghost Iron Ore","reqlevel":65,"slot":0,"source":[2,5,19,23],"sourcemore":[{"z":5840}],"subclass":7,firstseenpatch: 0,"avgbuyout":13168,"reqskill":755,"reqskillrank":500,"sellprice":1500,cost:[0,[],[[76061,1]]]},{"classs":7,"flags2":-2147475456,"id":72988,"level":86,"name":"6Windwool Cloth","slot":0,"source":[2,5],"sourcemore":[{"z":5840}],"subclass":5,firstseenpatch: 0,"avgbuyout":11111,"sellprice":1750,cost:[0,[],[[76061,1]]]},{"classs":7,"flags2":-2147475456,"id":52722,"level":85,"name":"3Maelstrom Crystal","slot":0,"source":[3,15],"sourcemore":[{"p":3}],"subclass":12,firstseenpatch: 0,"avgbuyout":32479,"buyprice":120000,cost:[0,[[392,3750]],[]]},{"classs":3,"flags2":-2147475456,"id":52196,"level":85,"name":"4Chimera's Eye","reqlevel":65,"slot":0,"source":[2,5],"sourcemore":[{"icon":"inv_misc_gem_ruby_01","n":"Fire Prism","q":3,"t":3,"ti":52304}],"subclass":8,firstseenpatch: 0,"avgbuyout":1960000,"reqskill":755,"reqskillrank":500,"sellprice":5000,cost:[0,[[361,1]],[]]},{"classs":7,"flags2":-2147475456,"id":52980,"level":85,"name":"4Pristine Hide","slot":0,"source":[5],"subclass":6,firstseenpatch: 0,"avgbuyout":1287000,"buyprice":130000,"sellprice":32500,cost:[0,[],[[56516,10]]]},{"classs":7,"flags2":-2147459072,"id":65893,"level":85,"name":"4Sands of Time","reqlevel":65,"slot":0,"source":[5],"subclass":11,firstseenpatch: 0,"avgbuyout":29000000,"buyprice":30000000,"reqskill":171,"reqskillrank":525,cost:[30000000]},{"classs":0,"flags2":8192,"id":58265,"level":85,"name":"6Highland Pomegranate","reqlevel":85,"slot":0,"source":[2,5],"sourcemore":[{"icon":"inv_crate_03","n":"Sealed Crate","q":1,"t":3,"ti":67597}],"subclass":5,firstseenpatch: 0,"avgbuyout":44000,"buyprice":20000,"cooldown":1000,"reqlevel":85,"sellprice":1000,cost:[20000]},{"classs":7,"flags2":-2147475456,"id":65892,"level":85,"name":"6Pyrium-Laced Crystalline Vial","slot":0,"source":[5],"sourcemore":[{"n":"Yasmin","t":1,"ti":49406,"z":5034}],"subclass":11,firstseenpatch: 0,"avgbuyout":1,"buyprice":50000000,"sellprice":125000,cost:[50000000]},{"classs":7,"flags2":-2147475456,"id":67319,"level":85,"name":"6Preserved Ogre Eye","slot":0,"source":[2,5],"sourcemore":[{"icon":"inv_box_04","n":"Flame-Scarred Junkbox","q":1,"t":3,"ti":63349},{"z":4922}],"subclass":1,firstseenpatch: 0,"avgbuyout":640000,"buyprice":328990,"sellprice":8224,cost:[328990]},{"classs":7,"flags2":-2147475456,"id":67335,"level":85,"name":"6Silver Charm Bracelet","slot":0,"source":[2,5],"sourcemore":[{"icon":"inv_box_04","n":"Flame-Scarred Junkbox","q":1,"t":3,"ti":63349},{"z":4922}],"subclass":1,firstseenpatch: 0,"avgbuyout":384000,"buyprice":445561,"sellprice":11139,cost:[445561]},{"classs":7,"flags2":-2147475456,"id":74659,"level":85,"name":"6Farm Chicken","slot":0,"source":[5],"subclass":8,firstseenpatch: 0,"avgbuyout":20000,"buyprice":30000,"sellprice":7500,cost:[30000]},{"classs":7,"flags2":-2147475456,"id":74660,"level":85,"name":"6Pandaren Peach","slot":0,"source":[5],"subclass":8,firstseenpatch: 0,"avgbuyout":11250,"buyprice":15000,"sellprice":3750,cost:[15000]},{"classs":7,"flags2":-2147475456,"id":74661,"level":85,"name":"6Black Pepper","reqlevel":85,"slot":0,"source":[4,5],"sourcemore":[{"c":5981,"c2":12,"n":"A Present for Teacher","t":5,"ti":31820},{"n":"Nam Ironpaw","t":1,"ti":64395,"z":5805}],"subclass":8,firstseenpatch: 0,"avgbuyout":60000,"buyprice":10000,"sellprice":2500,cost:[0,[[402,1]],[]]},{"classs":7,"flags2":-2147475456,"id":74662,"level":85,"name":"6Rice Flour","reqlevel":85,"slot":0,"source":[4,5],"sourcemore":[{"c":5981,"c2":12,"n":"A Present for Teacher","t":5,"ti":31820},{"n":"Nam Ironpaw","t":1,"ti":64395,"z":5805}],"subclass":8,firstseenpatch: 0,"avgbuyout":196000,"buyprice":10000,"sellprice":2500,cost:[0,[[402,1]],[]]},{"classs":7,"flags2":-2147475456,"id":74832,"level":85,"name":"6Barley","slot":0,"source":[5],"subclass":8,firstseenpatch: 0,"avgbuyout":116400,"buyprice":12000,"sellprice":3000,cost:[12000]},{"classs":7,"flags2":-2147475456,"id":74845,"level":85,"name":"6Ginseng","reqlevel":85,"slot":0,"source":[4,5],"sourcemore":[{"c":5981,"c2":12,"n":"Way of the Brew","t":5,"ti":31479}],"subclass":8,firstseenpatch: 0,"avgbuyout":99500,"buyprice":35000,"sellprice":8750,cost:[35000]},{"classs":7,"flags2":-2147475456,"id":74851,"level":85,"name":"6Rice","slot":0,"source":[5],"subclass":8,firstseenpatch: 0,"avgbuyout":69999,"buyprice":14000,"sellprice":3500,cost:[14000]},{"classs":7,"flags2":-2147475456,"id":74852,"level":85,"name":"6Yak Milk","slot":0,"source":[5],"subclass":8,firstseenpatch: 0,"avgbuyout":7500,"buyprice":16000,"sellprice":4000,cost:[16000]},{"classs":7,"flags2":-2147475456,"id":74853,"level":85,"name":"6100 Year Soy Sauce","reqlevel":85,"slot":0,"source":[4,5],"sourcemore":[{"c":5981,"c2":12,"n":"A Present for Teacher","t":5,"ti":31820},{"n":"Nam Ironpaw","t":1,"ti":64395,"z":5805}],"subclass":8,firstseenpatch: 0,"avgbuyout":307000,"buyprice":10000,"sellprice":2500,cost:[0,[[402,1]],[]]},{"classs":7,"flags2":-2147475456,"id":74854,"level":85,"name":"6Instant Noodles","slot":0,"source":[5],"subclass":8,firstseenpatch: 0,"avgbuyout":61222,"buyprice":7000,"sellprice":1750,cost:[7000]},{"classs":7,"flags2":-2147475456,"id":85583,"level":85,"name":"6Needle Mushrooms","slot":0,"source":[5],"subclass":8,firstseenpatch: 0,"avgbuyout":65000,"buyprice":12000,"sellprice":3000,cost:[12000]},{"classs":7,"flags2":-2147475456,"id":85584,"level":85,"name":"6Silkworm Pupa","slot":0,"source":[5],"subclass":8,firstseenpatch: 0,"buyprice":17000,"sellprice":4250,cost:[17000]},{"classs":7,"flags2":-2147475456,"id":85585,"level":85,"name":"6Red Beans","slot":0,"source":[5],"subclass":8,firstseenpatch: 0,"avgbuyout":4500,"buyprice":27000,"sellprice":6750,cost:[27000]},{"classs":7,"flags2":-2147475456,"id":102539,"level":85,"name":"6Fresh Strawberries","slot":0,"source":[5],"sourcemore":[{"n":"Merchant Tantan","t":1,"ti":59341}],"subclass":8,firstseenpatch: 0,"buyprice":5000,"sellprice":250,cost:[5000]},{"classs":7,"flags2":-2147475456,"id":102540,"level":85,"name":"6Fresh Mangos","slot":0,"source":[5],"sourcemore":[{"n":"Merchant Tantan","t":1,"ti":59341}],"subclass":8,firstseenpatch: 0,"buyprice":5000,"sellprice":250,cost:[5000]},{"classs":7,"flags2":-2147475456,"id":52719,"level":83,"name":"5Greater Celestial Essence","slot":0,"source":[3,15],"sourcemore":[{"p":3}],"subclass":12,firstseenpatch: 0,"avgbuyout":12425,"buyprice":120000,"cooldown":500,cost:[0,[[392,400]],[]]},{"classs":7,"flags2":-2147475456,"id":52185,"level":83,"name":"6Elementium Ore","reqlevel":65,"slot":0,"source":[2,3,19],"sourcemore":[{"p":3}],"subclass":7,firstseenpatch: 0,"avgbuyout":18524,"buyprice":180000,"reqskill":755,"reqskillrank":475,"sellprice":2250,cost:[0,[[392,1000]],[]]},{"classs":7,"flags2":-2147475456,"id":52188,"level":81,"name":"6Jeweler's Setting","slot":0,"source":[5],"subclass":1,firstseenpatch: 0,"avgbuyout":55000,"buyprice":15000,"sellprice":3750,cost:[15000]},{"classs":7,"flags2":-2147475456,"id":52555,"level":81,"name":"6Hypnotic Dust","slot":0,"source":[3,15],"sourcemore":[{"p":3}],"subclass":12,firstseenpatch: 0,"avgbuyout":106274,"buyprice":24000,cost:[0,[[392,100]],[]]},{"classs":7,"flags2":-2147475456,"id":53010,"level":81,"name":"6Embersilk Cloth","slot":0,"source":[2,3],"sourcemore":[{"p":3}],"subclass":5,firstseenpatch: 0,"avgbuyout":9950,"buyprice":120000,"sellprice":1500,cost:[0,[[392,1250]],[]]},{"classs":7,"flags2":-2147475456,"id":62323,"level":81,"name":"6Deathwing Scale Fragment","slot":0,"source":[2,5],"sourcemore":[{"icon":"inv_box_04","n":"Flame-Scarred Junkbox","q":1,"t":3,"ti":63349},{"z":4922}],"subclass":1,firstseenpatch: 0,"avgbuyout":480000,"buyprice":60000,"sellprice":5000,cost:[60000]},{"classs":3,"flags2":-2147475456,"id":42225,"level":80,"name":"4Dragon's Eye","reqlevel":35,"slot":0,"source":[2,5],"sourcemore":[{"icon":"inv_misc_gem_diamond_02","n":"Icy Prism","q":3,"t":3,"ti":44943}],"subclass":8,firstseenpatch: 0,"avgbuyout":444999,"reqskill":755,"reqskillrank":350,cost:[0,[[61,1]],[]]},{"classs":7,"flags2":-2147458816,"id":43102,"level":80,"name":"4Frozen Orb","slot":0,"source":[2,5],"sourcemore":[{"bd":1,"z":4395}],"subclass":11,firstseenpatch: 0,"avgbuyout":133155,"buyprice":750000,"sellprice":2000,cost:[750000]},{"classs":7,"flags2":-2147475456,"id":44499,"level":80,"name":"4Salvaged Iron Golem Parts","reqlevel":50,"slot":0,"source":[5],"subclass":1,firstseenpatch: 0,"buyprice":30000000,"reqskill":202,"reqskillrank":450,cost:[30000000]},{"classs":7,"flags2":-2147475456,"id":44500,"level":80,"name":"4Elementium-Plated Exhaust Pipe","reqlevel":50,"slot":0,"source":[5],"subclass":1,firstseenpatch: 0,"avgbuyout":9999999,"buyprice":15000000,"reqskill":202,"reqskillrank":450,cost:[15000000]},{"classs":7,"flags2":-2147475456,"id":44501,"level":80,"name":"4Goblin-Machined Piston","reqlevel":50,"slot":0,"source":[5],"subclass":1,firstseenpatch: 0,"buyprice":10000000,"reqskill":202,"reqskillrank":450,cost:[10000000]},{"classs":7,"flags2":-2147459072,"id":45087,"level":80,"name":"4Runed Orb","slot":0,"source":[2,5],"sourcemore":[{"z":4273},{"z":4395}],"subclass":11,firstseenpatch: 0,"avgbuyout":48069,"buyprice":1000000,"sellprice":2000,cost:[0,[],[[43102,4]]]},{"classs":7,"flags2":-2147459072,"id":47556,"level":80,"name":"4Crusader Orb","slot":0,"source":[2,5],"sourcemore":[{"bd":1,"z":4722}],"subclass":11,firstseenpatch: 0,"avgbuyout":58905,"buyprice":1250000,"sellprice":2000,cost:[0,[],[[43102,6]]]},{"classs":7,"flags2":-2147459072,"id":49908,"level":80,"name":"4Primordial Saronite","slot":0,"source":[2,5],"sourcemore":[{"z":4812}],"subclass":11,firstseenpatch: 0,"avgbuyout":698800,"buyprice":1500000,"sellprice":70000,cost:[1500000]},{"classs":7,"flags2":-2147475456,"id":36908,"level":80,"name":"5Frost Lotus","slot":0,"source":[2,5,17],"sourcemore":[{"n":"Frozo the Renowned","t":1,"ti":40160,"z":4395}],"subclass":9,firstseenpatch: 0,"avgbuyout":9599,"buyprice":40000,"sellprice":10000,cost:[0,[],[[43102,1]]]},{"classs":7,"flags2":-2147475456,"id":40533,"level":80,"name":"6Walnut Stock","slot":0,"source":[5],"subclass":1,firstseenpatch: 0,"avgbuyout":50000,"buyprice":50000,"sellprice":12500,cost:[50000]},{"classs":7,"flags2":-2147475456,"id":43007,"level":80,"name":"6Northern Spices","slot":0,"source":[2,5],"sourcemore":[{"icon":"inv_misc_bag_11","n":"Small Spice Bag","q":1,"t":3,"ti":44113}],"subclass":11,firstseenpatch: 0,"avgbuyout":4453,cost:[0,[[81,1]],[]]},{"classs":7,"flags2":-2147459072,"id":30183,"level":75,"name":"3Nether Vortex","slot":0,"source":[2,5],"sourcemore":[{"n":"G'eras","t":1,"ti":18525,"z":3703}],"subclass":13,firstseenpatch: 0,"avgbuyout":19053,"buyprice":700000,"sellprice":20000,cost:[700000]},{"classs":3,"flags2":-2147475456,"id":36784,"level":75,"name":"4Siren's Tear","slot":0,"source":[2,5],"sourcemore":[{"n":"Ahlurglgr","t":1,"ti":25206,"z":3537}],"subclass":7,firstseenpatch: 0,"avgbuyout":140000,"sellprice":10000,cost:[0,[],[[34597,100]]]},{"classs":7,"flags2":-2147475456,"id":44128,"level":75,"name":"4Arctic Fur","slot":0,"source":[5,23],"sourcemore":[{"n":"Braeg Stoutbeard","t":1,"ti":32515,"z":4395}],"subclass":6,firstseenpatch: 0,"avgbuyout":103774,"buyprice":120000,"sellprice":30000,cost:[0,[],[[38425,10]]]},{"classs":3,"flags2":-2147475456,"id":36783,"level":75,"name":"5Northsea Pearl","slot":0,"source":[2,5],"sourcemore":[{"n":"Ahlurglgr","t":1,"ti":25206,"z":3537}],"subclass":7,firstseenpatch: 0,"avgbuyout":70000,"sellprice":5000,cost:[0,[],[[34597,30]]]},{"classs":0,"flags2":8192,"id":35948,"level":75,"name":"6Savory Snowplum","reqlevel":75,"slot":0,"source":[2,5,21],"subclass":5,firstseenpatch: 0,"avgbuyout":22000,"buyprice":16000,"cooldown":1000,"reqlevel":75,"sellprice":800,cost:[16000]},{"classs":0,"flags2":8192,"id":58278,"level":75,"name":"6Tropical Sunfruit","reqlevel":75,"slot":0,"source":[5],"subclass":5,firstseenpatch: 0,"avgbuyout":52400,"buyprice":16000,"cooldown":1000,"reqlevel":75,"sellprice":800,cost:[16000]},{"classs":7,"flags2":-2147475456,"id":39684,"level":71,"name":"6Hair Trigger","slot":0,"source":[5],"subclass":1,firstseenpatch: 0,"avgbuyout":230000,"buyprice":9000,"sellprice":2250,cost:[9000]},{"classs":7,"flags2":-2147475456,"id":22791,"level":70,"name":"6Netherbloom","reqlevel":20,"slot":0,"source":[2,5,17],"subclass":9,firstseenpatch: 0,"avgbuyout":38800,"buyprice":4000,"reqskill":773,"reqskillrank":275,"sellprice":1000,cost:[4000]},{"classs":7,"flags2":-2147475456,"id":22793,"level":70,"name":"6Mana Thistle","reqlevel":20,"slot":0,"source":[5,17],"subclass":9,firstseenpatch: 0,"avgbuyout":16000,"buyprice":6000,"reqskill":773,"reqskillrank":275,"sellprice":1500,cost:[6000]},{"armor":0,"classs":4,"flags2":24576,"id":34249,"level":70,"name":"6Hula Girl Doll","slot":2,"slotbak":2,"source":[5],"subclass":-3,firstseenpatch: 0,"avgbuyout":1999749,"buyprice":1000000,"sellprice":250000,"slotbak":2,cost:[1000000]},{"classs":7,"flags2":-2147475456,"id":38426,"level":70,"name":"6Eternium Thread","slot":0,"source":[2,5],"subclass":5,firstseenpatch: 0,"avgbuyout":15000,"buyprice":30000,"sellprice":7500,cost:[30000]},{"classs":7,"flags2":-2147459072,"id":23572,"level":65,"name":"4Primal Nether","slot":0,"source":[2,5],"sourcemore":[{"bd":1,"n":"G'eras","t":1,"ti":18525,"z":3703}],"subclass":13,firstseenpatch: 0,"avgbuyout":14799,"buyprice":500000,"sellprice":16000,cost:[500000]},{"classs":7,"flags2":-2147475456,"id":22577,"level":65,"name":"6Mote of Shadow","slot":0,"source":[2,5],"subclass":10,firstseenpatch: 0,"avgbuyout":9800,"buyprice":1600,"cooldown":500,"sellprice":400,cost:[1600]},{"classs":7,"flags2":-2147475456,"id":22578,"level":65,"name":"6Mote of Water","slot":0,"source":[2,5,16],"subclass":10,firstseenpatch: 0,"avgbuyout":10050,"buyprice":1600,"cooldown":500,"sellprice":400,cost:[1600]},{"classs":0,"flags2":8192,"id":27860,"level":65,"name":"6Purified Draenic Water","reqlevel":65,"slot":0,"source":[2,5],"subclass":5,firstseenpatch: 0,"buyprice":6400,"cooldown":1000,"reqlevel":65,"sellprice":320,cost:[6400]},{"classs":0,"flags2":8192,"id":35949,"level":65,"name":"6Tundra Berries","reqlevel":65,"slot":0,"source":[5],"subclass":5,firstseenpatch: 0,"avgbuyout":30000,"buyprice":8500,"cooldown":1000,"reqlevel":65,"sellprice":425,cost:[8500]},{"classs":7,"flags2":-2147475456,"id":18567,"level":60,"name":"6Elemental Flux","slot":0,"source":[5],"subclass":7,firstseenpatch: 0,"buyprice":30000,"sellprice":7500,cost:[30000]},{"classs":7,"flags2":-2147475456,"id":22785,"level":60,"name":"6Felweed","reqlevel":20,"slot":0,"source":[5,17],"subclass":9,firstseenpatch: 0,"avgbuyout":14141,"buyprice":2000,"reqskill":773,"reqskillrank":275,"sellprice":500,cost:[2000]},{"classs":7,"flags2":-2147475456,"id":22786,"level":60,"name":"6Dreaming Glory","reqlevel":20,"slot":0,"source":[2,5,17],"subclass":9,firstseenpatch: 0,"avgbuyout":12637,"buyprice":2000,"reqskill":773,"reqskillrank":275,"sellprice":500,cost:[2000]},{"classs":7,"flags2":-2147475456,"id":13467,"level":58,"name":"6Icecap","reqlevel":10,"slot":0,"source":[2,5,17],"subclass":9,firstseenpatch: 0,"avgbuyout":12500,"buyprice":1000,"reqskill":773,"reqskillrank":200,"sellprice":250,cost:[1000]},{"classs":7,"flags2":-2147475456,"id":4342,"level":50,"name":"6Purple Dye","slot":0,"source":[5],"subclass":11,firstseenpatch: 0,"buyprice":2500,"sellprice":625,cost:[2500]},{"classs":7,"flags2":-2147475456,"id":8846,"level":50,"name":"6Gromsblood","reqlevel":10,"slot":0,"source":[2,5,17],"sourcemore":[{"n":"Vi'el","t":1,"ti":16015,"z":618}],"subclass":9,firstseenpatch: 0,"avgbuyout":16666,"buyprice":1000,"reqskill":773,"reqskillrank":175,"sellprice":250,cost:[1000]},{"classs":7,"flags2":-2147475456,"id":10290,"level":50,"name":"6Pink Dye","slot":0,"source":[5],"subclass":11,firstseenpatch: 0,"avgbuyout":1850,"buyprice":2500,"sellprice":625,cost:[2500]},{"classs":7,"flags2":-2147475456,"id":10647,"level":50,"name":"6Engineer's Ink","slot":0,"source":[5],"subclass":1,firstseenpatch: 0,"avgbuyout":99999,"buyprice":2000,"sellprice":500,cost:[2000]},{"classs":7,"flags2":-2147475456,"id":14256,"level":50,"name":"6Felcloth","slot":0,"source":[2,5],"sourcemore":[{"n":"Vi'el","t":1,"ti":16015,"z":618}],"subclass":5,firstseenpatch: 0,"avgbuyout":49498,"buyprice":8000,"sellprice":2000,cost:[8000]},{"classs":7,"flags2":-2147475456,"id":14341,"level":50,"name":"6Rune Thread","slot":0,"source":[5],"subclass":5,firstseenpatch: 0,"avgbuyout":14000,"buyprice":5000,"sellprice":1250,cost:[5000]},{"classs":0,"flags2":8192,"id":34412,"level":45,"name":"6Sparkling Apple Cider","reqlevel":35,"slot":0,"source":[5],"subclass":0,firstseenpatch: 0,"buyprice":1000,"cooldown":1000,"manargn":563,"reqlevel":35,"sellprice":50,"spi":11,"sta":11,cost:[1000]},{"classs":7,"flags2":-2147475456,"id":2325,"level":40,"name":"6Black Dye","slot":0,"source":[5],"subclass":11,firstseenpatch: 0,"buyprice":1000,"sellprice":250,cost:[1000]},{"classs":7,"commondrop":true,"flags2":-2147475456,"id":4338,"level":40,"name":"6Mageweave Cloth","slot":0,"source":[2,5,21],"sourcemore":[{"n":"Andra","t":1,"ti":16631,"z":3487}],"subclass":5,firstseenpatch: 0,"avgbuyout":3361,"buyprice":1000,"sellprice":250,cost:[1000]},{"classs":7,"flags2":-2147475456,"id":8343,"level":40,"name":"6Heavy Silken Thread","slot":0,"source":[5],"subclass":5,firstseenpatch: 0,"avgbuyout":10799,"buyprice":2000,"sellprice":500,cost:[2000]},{"classs":0,"flags2":8192,"id":2595,"level":35,"name":"6Jug of Badlands Bourbon","slot":0,"source":[2,5],"subclass":5,firstseenpatch: 0,"avgbuyout":49800,"buyprice":2000,"cooldown":1000,"sellprice":500,cost:[2000]},{"classs":7,"flags2":-2147475456,"id":6261,"level":35,"name":"6Orange Dye","slot":0,"source":[5],"subclass":11,firstseenpatch: 0,"buyprice":1000,"sellprice":250,cost:[1000]},{"classs":7,"flags2":-2147475456,"id":3357,"level":30,"name":"6Liferoot","slot":0,"source":[2,5,17],"subclass":9,firstseenpatch: 0,"avgbuyout":11800,"buyprice":300,"reqskill":773,"reqskillrank":75,"sellprice":75,cost:[300]},{"classs":7,"flags2":-2147475456,"id":3857,"level":30,"name":"6Coal","slot":0,"source":[2,5,16],"subclass":7,firstseenpatch: 0,"avgbuyout":1995,"buyprice":500,"sellprice":125,cost:[500]},{"classs":7,"flags2":-2147475456,"id":4291,"level":30,"name":"6Silken Thread","slot":0,"source":[5],"subclass":5,firstseenpatch: 0,"buyprice":500,"sellprice":125,cost:[500]},{"classs":7,"commondrop":true,"flags2":-2147475456,"id":4306,"level":30,"name":"6Silk Cloth","slot":0,"source":[2,5,21],"sourcemore":[{"n":"Andra","t":1,"ti":16631,"z":3487}],"subclass":5,firstseenpatch: 0,"avgbuyout":11248,"buyprice":600,"sellprice":150,cost:[600]},{"classs":7,"flags2":-2147475456,"id":11291,"level":30,"name":"6Star Wood","slot":0,"source":[5],"subclass":11,firstseenpatch: 0,"avgbuyout":140000,"buyprice":4500,"sellprice":1125,cost:[4500]},{"classs":7,"flags2":-2147475456,"id":12037,"level":30,"name":"6Mystery Meat","slot":0,"source":[2,5],"sourcemore":[{"n":"Anton","t":1,"ti":24291,"z":495}],"subclass":8,firstseenpatch: 0,"avgbuyout":180,"buyprice":350,"sellprice":87,cost:[350]},{"classs":0,"flags2":8192,"id":2594,"level":25,"name":"6Flagon of Dwarven Mead","slot":0,"source":[2,5],"sourcemore":[{"bd":1,"dd":-1,"n":"Stomper Kreeg","t":1,"ti":14322,"z":2557}],"subclass":5,firstseenpatch: 0,"avgbuyout":50000,"buyprice":1500,"cooldown":1000,"sellprice":375,cost:[1500]},{"classs":7,"flags2":-2147475456,"id":3466,"level":25,"name":"6Strong Flux","slot":0,"source":[5],"subclass":11,firstseenpatch: 0,"avgbuyout":20000,"buyprice":2000,"sellprice":500,cost:[2000]},{"classs":7,"flags2":-2147475456,"id":4340,"level":25,"name":"6Gray Dye","slot":0,"source":[5],"subclass":11,firstseenpatch: 0,"avgbuyout":35000,"buyprice":350,"sellprice":87,cost:[350]},{"classs":7,"flags2":-2147475456,"id":4341,"level":25,"name":"6Yellow Dye","slot":0,"source":[5],"subclass":11,firstseenpatch: 0,"avgbuyout":15200,"buyprice":500,"sellprice":125,cost:[500]},{"classs":7,"flags2":-2147475456,"id":4400,"level":25,"name":"6Heavy Stock","slot":0,"source":[5],"subclass":1,firstseenpatch: 0,"buyprice":2000,"sellprice":500,cost:[2000]},{"classs":7,"flags2":-2147475456,"id":3356,"level":24,"name":"6Kingsblood","slot":0,"source":[2,5,17],"subclass":9,firstseenpatch: 0,"avgbuyout":11400,"buyprice":120,"reqskill":773,"reqskillrank":75,"sellprice":30,cost:[120]},{"classs":7,"flags2":-2147475456,"id":3355,"level":22,"name":"6Wild Steelbloom","slot":0,"source":[2,5,17],"subclass":9,firstseenpatch: 0,"avgbuyout":14800,"buyprice":200,"reqskill":773,"reqskillrank":75,"sellprice":50,cost:[200]},{"classs":7,"flags2":-2147475456,"id":2321,"level":20,"name":"6Fine Thread","slot":0,"source":[5],"subclass":5,firstseenpatch: 0,"avgbuyout":111111,"buyprice":100,"sellprice":25,cost:[100]},{"classs":7,"flags2":-2147475456,"id":2453,"level":20,"name":"6Bruiseweed","slot":0,"source":[2,5,17],"subclass":9,firstseenpatch: 0,"avgbuyout":9909,"buyprice":100,"reqskill":773,"reqskillrank":25,"sellprice":25,cost:[100]},{"classs":7,"flags2":-2147475456,"id":2771,"level":20,"name":"6Tin Ore","slot":0,"source":[2,5,19],"sourcemore":[{"n":"Rathis Tomber","t":1,"ti":16224,"z":3433}],"subclass":7,firstseenpatch: 0,"avgbuyout":7425,"buyprice":100,"reqskill":755,"reqskillrank":50,"sellprice":25,cost:[100]},{"classs":7,"flags2":-2147475456,"id":4232,"level":20,"name":"6Medium Hide","slot":0,"source":[2,5,23],"sourcemore":[{"n":"Murhane","t":1,"ti":44286,"z":4709}],"subclass":6,firstseenpatch: 0,"avgbuyout":22425,"buyprice":500,"sellprice":125,cost:[500]},{"classs":0,"flags2":8192,"id":6530,"level":20,"name":"6Nightcrawlers","slot":0,"source":[2,5],"subclass":-3,firstseenpatch: 0,"avgbuyout":1000,"buyprice":100,"reqskill":356,"reqskillrank":50,"sellprice":25,cost:[100]},{"classs":7,"commondrop":true,"flags2":-2147475456,"id":2592,"level":15,"name":"6Wool Cloth","slot":0,"source":[2,5,21],"sourcemore":[{"n":"Andra","t":1,"ti":16631,"z":3487}],"subclass":5,firstseenpatch: 0,"avgbuyout":5300,"buyprice":135,"sellprice":33,cost:[135]},{"classs":0,"flags2":8192,"id":2593,"level":15,"name":"6Flask of Stormwind Tawny","slot":0,"source":[2,5],"subclass":5,firstseenpatch: 0,"avgbuyout":34826,"buyprice":150,"cooldown":1000,"sellprice":37,cost:[150]},{"classs":0,"flags2":8192,"id":2596,"level":15,"name":"6Skin of Dwarven Stout","slot":0,"source":[2,5],"subclass":5,firstseenpatch: 0,"avgbuyout":40000,"buyprice":120,"cooldown":1000,"sellprice":30,cost:[120]},{"classs":7,"flags2":-2147475456,"id":2605,"level":15,"name":"6Green Dye","slot":0,"source":[5],"subclass":11,firstseenpatch: 0,"avgbuyout":9000,"buyprice":100,"sellprice":25,cost:[100]},{"classs":7,"flags2":-2147475456,"id":2775,"level":10,"name":"5Silver Ore","slot":0,"source":[2,5,19],"sourcemore":[{"n":"Rathis Tomber","t":1,"ti":16224,"z":3433}],"subclass":7,firstseenpatch: 0,"avgbuyout":60500,"buyprice":300,"sellprice":75,cost:[300]},{"classs":7,"flags2":-2147475456,"id":10938,"level":10,"name":"5Lesser Magic Essence","slot":0,"source":[5,15],"subclass":12,firstseenpatch: 0,"avgbuyout":15750,"buyprice":800,"cooldown":1000,cost:[800]},{"classs":7,"flags2":-2147475456,"id":785,"level":10,"name":"6Mageroyal","slot":0,"source":[2,4,5,17],"sourcemore":[{"c":-181,"c2":5,"n":"Elixirs for the Bladeleafs","t":5,"ti":1581}],"subclass":9,firstseenpatch: 0,"avgbuyout":9130,"buyprice":80,"reqskill":773,"sellprice":20,cost:[80]},{"classs":7,"flags2":-2147475456,"id":2449,"level":10,"name":"6Earthroot","slot":0,"source":[2,4,5,17],"sourcemore":[{"c":-181,"c2":5,"n":"Elixirs for the Bladeleafs","t":5,"ti":1581}],"subclass":9,firstseenpatch: 0,"avgbuyout":8300,"buyprice":80,"reqskill":773,"reqskillrank":1,"sellprice":20,cost:[80]},{"classs":7,"flags2":-2147475456,"id":2604,"level":10,"name":"6Red Dye","slot":0,"source":[5],"subclass":11,firstseenpatch: 0,"avgbuyout":48898,"buyprice":50,"sellprice":12,cost:[50]},{"classs":7,"flags2":-2147475456,"id":2770,"level":10,"name":"6Copper Ore","slot":0,"source":[2,5,19],"sourcemore":[{"n":"Rathis Tomber","t":1,"ti":16224,"z":3433}],"subclass":7,firstseenpatch: 0,"avgbuyout":10890,"buyprice":20,"reqskill":755,"reqskillrank":1,"sellprice":5,cost:[20]},{"classs":7,"flags2":-2147475456,"id":4289,"level":10,"name":"6Salt","slot":0,"source":[5],"subclass":6,firstseenpatch: 0,"buyprice":50,"sellprice":12,cost:[50]},{"classs":7,"flags2":-2147475456,"id":4399,"level":10,"name":"6Wooden Stock","slot":0,"source":[5],"subclass":1,firstseenpatch: 0,"avgbuyout":30000,"buyprice":200,"sellprice":50,cost:[200]},{"classs":7,"flags2":-2147475456,"id":6260,"level":10,"name":"6Blue Dye","slot":0,"source":[5],"subclass":11,firstseenpatch: 0,"avgbuyout":58000,"buyprice":50,"sellprice":12,cost:[50]},{"classs":7,"flags2":-2147475456,"id":10940,"level":10,"name":"6Strange Dust","slot":0,"source":[5,15],"subclass":12,firstseenpatch: 0,"avgbuyout":13600,"buyprice":800,cost:[800]},{"classs":7,"flags2":-2147475456,"id":765,"level":5,"name":"6Silverleaf","slot":0,"source":[2,5,17],"subclass":9,firstseenpatch: 0,"avgbuyout":8693,"buyprice":40,"reqskill":773,"reqskillrank":1,"sellprice":10,cost:[40]},{"classs":0,"flags2":8192,"id":1179,"level":5,"name":"6Ice Cold Milk","reqlevel":5,"slot":0,"source":[2,5],"subclass":5,firstseenpatch: 0,"avgbuyout":8573,"buyprice":125,"cooldown":1000,"manargn":216,"reqlevel":5,"sellprice":6,cost:[125]},{"classs":7,"flags2":-2147475456,"id":2320,"level":5,"name":"6Coarse Thread","slot":0,"source":[5],"subclass":5,firstseenpatch: 0,"avgbuyout":240000,"buyprice":10,"sellprice":2,cost:[10]},{"classs":7,"flags2":-2147475456,"id":2324,"level":5,"name":"6Bleach","slot":0,"source":[5],"subclass":11,firstseenpatch: 0,"buyprice":25,"sellprice":6,cost:[25]},{"classs":7,"flags2":-2147475456,"id":2447,"level":5,"name":"6Peacebloom","slot":0,"source":[2,5,17],"subclass":9,firstseenpatch: 0,"avgbuyout":8667,"buyprice":40,"reqskill":773,"reqskillrank":1,"sellprice":10,cost:[40]},{"classs":7,"commondrop":true,"flags2":-2147475456,"id":2589,"level":5,"name":"6Linen Cloth","slot":0,"source":[2,5,16,17,19,21,23],"sourcemore":[{"n":"Andra","t":1,"ti":16631,"z":3487}],"subclass":5,firstseenpatch: 0,"avgbuyout":2309,"buyprice":55,"sellprice":13,cost:[55]},{"classs":7,"flags2":-2147475456,"id":2678,"level":5,"name":"6Mild Spices","slot":0,"source":[5],"subclass":11,firstseenpatch: 0,"avgbuyout":23200,"buyprice":10,cost:[10]},{"classs":7,"flags2":-2147475456,"id":2880,"level":5,"name":"6Weak Flux","slot":0,"source":[5],"subclass":11,firstseenpatch: 0,"avgbuyout":20000,"buyprice":100,"sellprice":25,cost:[100]},{"classs":7,"flags2":-2147475456,"id":4470,"level":5,"name":"6Simple Wood","slot":0,"source":[5],"subclass":11,firstseenpatch: 0,"avgbuyout":99000,"buyprice":38,"sellprice":9,cost:[38]},{"classs":0,"flags2":8192,"id":4537,"level":5,"name":"6Tel'Abim Banana","reqlevel":5,"slot":0,"source":[2,5,21],"subclass":5,firstseenpatch: 0,"avgbuyout":6000000,"buyprice":125,"cooldown":1000,"reqlevel":5,"sellprice":6,cost:[125]},{"classs":7,"flags2":8192,"id":6217,"level":5,"name":"6Copper Rod","slot":0,"source":[5],"subclass":12,firstseenpatch: 0,"avgbuyout":120000,"buyprice":124,"sellprice":24,"speed":2.00,cost:[124]},{"classs":15,"flags2":-2147475456,"id":17194,"level":5,"name":"6Holiday Spices","slot":0,"source":[5],"subclass":3,firstseenpatch: 0,"avgbuyout":10000,"buyprice":10,cost:[10]},{"classs":15,"flags2":8192,"id":17202,"level":5,"name":"6Snowball","slot":0,"source":[2,5],"subclass":3,firstseenpatch: 0,"avgbuyout":9897,"buyprice":10,"cooldown":1000,cost:[10]},{"classs":7,"flags2":-2147475456,"id":30817,"level":5,"name":"6Simple Flour","slot":0,"source":[5],"subclass":11,firstseenpatch: 0,"avgbuyout":10000,"buyprice":25,"sellprice":1,cost:[25]},{"classs":7,"flags2":-2147475456,"id":44835,"level":5,"name":"6Autumnal Herbs","slot":0,"source":[5],"subclass":11,firstseenpatch: 0,"buyprice":10,cost:[10]},{"appearances":{"0":[1379,""]},"classs":2,"displayid":1379,"dps":1.18,"flags2":8192,"id":2901,"level":4,"name":"6Mining Pick","slot":21,"slotbak":21,"source":[5],"speed":2.00,"subclass":14,firstseenpatch: 0,"buyprice":81,"displayid":1379,"dmgmax1":3,"dmgmin1":1,"dmgrange":0.60,"dmgtype1":0,"dps":1.18,"dura":20,"mledmgmax":3,"mledmgmin":1,"mledps":1.18,"mlespeed":2.00,"reqlevel":1,"reqskill":186,"reqskillrank":1,"sellprice":16,"slotbak":21,"speed":2.00,cost:[81]},{"appearances":{"0":[2706,""]},"classs":2,"displayid":2706,"dps":1.37,"flags2":8192,"id":7005,"level":4,"name":"6Skinning Knife","slot":13,"slotbak":13,"source":[2,5],"sourcemore":[{"icon":"inv_crate_05","n":"Crate of Meat","q":1,"t":3,"ti":33857}],"speed":1.60,"subclass":14,firstseenpatch: 0,"avgbuyout":20000000,"buyprice":82,"displayid":2706,"dmgmax1":3,"dmgmin1":1,"dmgrange":0.60,"dmgtype1":0,"dps":1.37,"dura":20,"mledmgmax":3,"mledmgmin":1,"mledps":1.37,"mlespeed":1.60,"reqlevel":1,"reqskill":393,"reqskillrank":1,"sellprice":16,"slotbak":13,"speed":1.60,cost:[82]},{"classs":0,"flags2":8192,"id":159,"level":1,"name":"6Refreshing Spring Water","reqlevel":5,"slot":0,"source":[2,4,5,16],"subclass":5,firstseenpatch: 0,"avgbuyout":100000,"buyprice":25,"cooldown":1000,"manargn":90,"reqlevel":1,"sellprice":1,cost:[25]},{"classs":7,"flags2":-2147475456,"id":3371,"level":1,"name":"6Crystal Vial","slot":0,"source":[2,5,16],"subclass":11,firstseenpatch: 0,"avgbuyout":136664,"buyprice":100,"sellprice":5,cost:[100]},{"classs":12,"flags2":-2147475456,"id":5051,"level":1,"name":"6Dig Rat","slot":0,"source":[2,5],"sourcemore":[{"n":"Dig Rat","t":1,"ti":3444,"z":4709},{"n":"Grub","t":1,"ti":3443,"z":17}],"subclass":0,firstseenpatch: 0,"avgbuyout":4,"buyprice":1,"sellprice":1,cost:[1]},{"appearances":{"0":[1597,"inv_hammer_03"]},"classs":2,"displayid":1597,"dps":0.43,"flags2":8192,"id":5956,"level":1,"name":"6Blacksmith Hammer","slot":21,"slotbak":21,"source":[5],"speed":2.00,"subclass":14,firstseenpatch: 0,"avgbuyout":363990,"buyprice":18,"displayid":1597,"dmgrange":0.60,"dps":0.43,"dura":16,"mledps":0.43,"mlespeed":2.00,"reqlevel":1,"sellprice":3,"slotbak":21,"speed":2.00,cost:[18]},{"classs":0,"flags2":8192,"id":9260,"level":1,"name":"6Volatile Rum","slot":0,"source":[2,5],"subclass":5,firstseenpatch: 0,"avgbuyout":20000,"buyprice":1600,"sellprice":400,cost:[1600]},{"classs":0,"flags2":8192,"id":17196,"level":1,"name":"6Holiday Spirits","slot":0,"source":[5],"subclass":5,firstseenpatch: 0,"avgbuyout":19800,"buyprice":50,"cooldown":1000,"reqlevel":1,"sellprice":12,cost:[50]},{"classs":7,"flags2":-2147475456,"id":39354,"level":1,"name":"6Light Parchment","slot":0,"source":[5],"subclass":11,firstseenpatch: 0,"avgbuyout":49500,"buyprice":15,"sellprice":1,cost:[15]},{"classs":7,"flags2":-2147475456,"id":44853,"level":1,"name":"6Honey","slot":0,"source":[5],"subclass":11,firstseenpatch: 0,"buyprice":25,"sellprice":1,cost:[25]},{"classs":0,"flags2":8192,"id":44854,"level":1,"name":"6Tangy Wetland Cranberries","slot":0,"source":[5],"sourcemore":[{"z":1}],"subclass":5,firstseenpatch: 0,"buyprice":25,"cooldown":1000,"reqlevel":1,"sellprice":1,cost:[25]},{"classs":0,"flags2":8192,"id":44855,"level":1,"name":"6Teldrassil Sweet Potato","slot":0,"source":[5],"sourcemore":[{"z":1657}],"subclass":5,firstseenpatch: 0,"buyprice":25,"cooldown":1000,"reqlevel":1,"sellprice":1,cost:[25]},{"classs":0,"flags2":8192,"id":46784,"level":1,"name":"6Ripe Elwynn Pumpkin","slot":0,"source":[5],"sourcemore":[{"z":12}],"subclass":5,firstseenpatch: 0,"buyprice":25,"cooldown":1000,"reqlevel":1,"sellprice":1,cost:[25]},{"classs":0,"flags2":8192,"id":46793,"level":1,"name":"6Tangy Southfury Cranberries","slot":0,"source":[5],"sourcemore":[{"z":14}],"subclass":5,firstseenpatch: 0,"buyprice":25,"cooldown":1000,"reqlevel":1,"sellprice":1,cost:[25]},{"classs":0,"flags2":8192,"id":46796,"level":1,"name":"6Ripe Tirisfal Pumpkin","slot":0,"source":[5],"sourcemore":[{"z":1497}],"subclass":5,firstseenpatch: 0,"buyprice":25,"cooldown":1000,"reqlevel":1,"sellprice":1,cost:[25]},{"classs":0,"flags2":8192,"id":46797,"level":1,"name":"6Mulgore Sweet Potato","slot":0,"source":[5],"sourcemore":[{"z":1638}],"subclass":5,firstseenpatch: 0,"buyprice":25,"cooldown":1000,"reqlevel":1,"sellprice":1,cost:[25]},{"appearances":{"0":[1716,""]},"classs":2,"displayid":1716,"dps":0.67,"flags2":8192,"id":79740,"level":1,"name":"6Plain Wooden Staff","slot":17,"slotbak":17,"source":[5],"speed":2.50,"subclass":10,firstseenpatch: 0,"buyprice":23,"displayid":1716,"dmgmax1":2,"dmgmin1":1,"dmgrange":0.40,"dmgtype1":0,"dps":0.67,"dura":25,"mledmgmax":2,"mledmgmin":1,"mledps":0.67,"mlespeed":2.50,"reqlevel":1,"sellprice":4,"slotbak":17,"speed":2.50,cost:[23]}
EOF;

$itms = json_decode2($thejson);
//print_r($itms);
//echo "-------------\n";

//these are unique vendors that are the only source for the given goods, but anyone can get to them and buy their unlimited-supply stuff
$allowedvendors = Array(14322,31247,19227,49406,61650);

//these are items that are excluded from the vendor list (probably because they are crafted) but should be considered vendor
$forcevendor = array();
$forcevendor[90146] = 20000; //tinker's kit

// items that are sold by vendors for gold but should be considered gathered
// northern spices, felcloth, strange dust, elementium ore, embersilk cloth, hypnotic dust, lesser magic essence
$forbiddenitems = Array(43007,14256,10940,52185,53010,52555,10938,74853);

// also exclude all herbs and elemental (motes, etc) trade goods
$sql = 'select id from tblDBCItem where class=7 and subclass in (9,10)';
$rst = get_rst($sql);
while ($row = next_row($rst)) $forbiddenitems[] = intval($row['id']);


foreach ($itms as $itm) {
    if (!isset($itm['id'])) {
        continue;
    }
	$gooditem = true;
	if (isset($itm['sourcemore'])) 
		foreach ($itm['sourcemore'] as $src) 
			if (isset($src['t'])) {
				if (($src['t']==1) && (!in_array($src['ti'],$allowedvendors))) 
					$gooditem=false;
			} /* else {
				echo "no t:\n";
				print_r($itm);
			} */
	if (in_array($itm['id'],$forbiddenitems)) $gooditem=false;
	if (isset($itm['cost']) && (strpos($itm['cost'],'[') !== false)) 
		$gooditem = false;
	$price = 0;
	if ($gooditem) {
		unset($sellprice); unset($buyprice);
		if (isset($itm['sellprice'])) $sellprice = $itm['sellprice'] * 4;
		if (isset($itm['buyprice'])) $buyprice = $itm['buyprice'];

		if (isset($sellprice) && isset($buyprice) && ($sellprice != $buyprice)) { // && (floor($buyprice/4) != floor($sellprice/4))) {
			echo substr($itm['name'],1).": *** sell/buy mismatch: $sellprice vs $buyprice ..";
			if (file_exists('vendoritems.wowheadcache/'.$itm['id'].'.html')) {
				$wh = file_get_contents('vendoritems.wowheadcache/'.$itm['id'].'.html');
			} else {
				$wh = get_url_old('http://www.wowhead.com/item='.$itm['id']);
				file_put_contents('vendoritems.wowheadcache/'.$itm['id'].'.html',$wh);
			}
			$stacksize = 0;
			if (preg_match('/\n[^\n]+\'npc\', id: \'sold-by\'([^\n]+)+\n/',$wh,$res) > 0) {
				$c = preg_match_all('/\bstack:(\d+)/',$res[1],$res2);
				for ($x = 0; $x < $c; $x++) $stacksize=max($stacksize,intval($res2[1][$x]));
			}
			$price = $buyprice; 
			if ($stacksize != 0) $price = round($price / $stacksize);
		} else {
			if (isset($itm['sellprice'])) $price = $itm['sellprice'] * 4;
			if (isset($itm['buyprice'])) $price = $itm['buyprice'];
			echo substr($itm['name'],1).":";
		}

		echo " $price ".run_sql('replace into tblDBCItemVendorCost (item, copper) values (\''.sql_esc($itm['id']).'\', \''.sql_esc($price).'\')')."\n";
	}
}

foreach ($forcevendor as $iid => $c) 
	run_sql('replace into tblDBCItemVendorCost (item, copper) values (\''.sql_esc($iid).'\', \''.sql_esc($c).'\')');


?>
